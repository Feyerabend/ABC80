1000 ! SNAKE3.BAS
1010 EXTEND : RANDOMIZE : INTEGER : WIDTH 80
1020 ! main
1030 T=FNInit
1040 WHILE 1
1050   T=FNGkey
1060   IF Fx=X AND Fy=Y THEN T=FNGeat ELSE T=FNGtest
1070   IF T THEN 1120
1080   T=FNGmove
1090   T=FNGshift
1100   T=FNGdraw
1110 WEND
1120 ; CUR(10,30);CHR$(135) 'G A M E   O V E R' CHR$(151);
1130 ; CUR(12,34);CHR$(135) 'Score: ';Score;CHR$(151);
1140 END
1150 ! end of main
1160 !
1170 ! init of game
1180 DEF FNInit
1190   Cu1=1
1200   Fx=0 : Fy=0
1210   Mx=79*2 : My=71
1220   T=FNGfood
1230   Smin=5
1240   Tail=Smin
1250   Smax=500
1260   DIM R(Smax),C(Smax)
1270   R(0)=5 : R(1)=4 : R(2)=3 : R(3)=2 : R(4)=1
1280   T=Mx/2
1290   C(0)=T : C(1)=T : C(2)=T : C(3)=T : C(5)=T
1300   R1=R(Tail-1) : C1=C(Tail-1)
1310   Score=0
1320   T=FNGinit
1330   RETURN 0
1340 FNEND
1350 ! keys
1360 DEF FNGkey LOCAL K,Cu
1370   K=ABS(SYS(8)*INP(34))
1380   IF 97=K AND Cu1<>3 THEN Cu=1
1390   IF 115=K AND Cu1<>1 THEN Cu=3
1400   IF 122=K AND Cu1<>4 THEN Cu=2
1410   IF 119=K AND Cu1<>2 THEN Cu=4
1420   X=R(0) : Y=C(0)
1430   IF Cu=0 Cu=Cu1
1440   ON Cu GOTO 1430,1440,1450,1460
1450   Y=Y-1 : GOTO 1470
1460   X=X+1 : GOTO 1470
1470   Y=Y+1 : GOTO 1470
1480   X=X-1 : GOTO 1470
1490   Cu1=Cu
1500   RETURN 0
1510 FNEND
1520 ! graphics init
1530 DEF FNGinit
1540   ; CHR$(12);
1550   FOR I=0 TO 23
1560     ; CUR(I,0);GWHT;
1570   NEXT I
1580   FOR I=2 TO Mx
1590     SET DOT 0,I : SET DOT I,Mx
1600   NEXT I
1610   FOR I=0 TO My
1620     SET DOT I,2 : SET DOT I,My
1630   NEXT I
1640   RETURN 0
1650 FNEND
1660 ! create food
1670 DEF FNGfood
1680   Fx=INT(RND*(Mx/2-20))+10
1690   Fy=INT(RND*(My-10))+5
1700   RETURN 0
1710 FNEND
1720 ! shift snake
1730 DEF FNshift LOCAL Tr,Tc
1740   Tr=R(Tail-1)
1750   Tc=C(Tail-1)
1760   FOR I=Tail TO 1 STEP -1
1770     R(I)=R(I-1) : C(I)=C(I-1)
1780   NEXT I
1790   R(0)=Tr : C(0)=Tc
1800 RETURN 0
1810 FNEND
1820 ! eat food
1830 DEF FNGeat
1840   R(Tail)=X
1850   C(Tail)=Y
1860   IF Tail<Smax THEN Tail=Tail+1 ELSE Tail=Smax
1870   Score=Score+1
1880   T=FNGfood
1890   RETURN 0
1900 FNEND
1910 ! move
1920 DEF FNGmove
1930   R(Tail-1)=X : C(Tail-1)=Y
1940   RETURN 0
1950 FNEND
1960 ! test DOT
1970 DEF FNGtest
1980   IF DOT(X,Y) RETURN -1
1990   RETURN 0
2000 FNEND
2010 ! draw
2020 DEF FNGdraw LOCAL T
2030   T=Tail-1
2040   CLR DOT R1,C1
2050   FOR I=0 TO T
2060     SET DOT R(1),C(I)
2070   NEXT I
2080   R1=R(T) : C1=C(T)
2090   SET DOT Fx,Fy
2100   RETURN 0
2110 FNEND
2120 ! S. Lonnert, public domain 2024
